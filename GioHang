
package bookStore;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;


public class GioHang {
    private ArrayList<CT_GioHang> dsGioHang = new ArrayList<>();

    public ArrayList<CT_GioHang> getDsGioHang() {
        return dsGioHang;
    }

    public void setDsGioHang(ArrayList<CT_GioHang> dsGioHang) {
        this.dsGioHang = dsGioHang;
    }


    
//    public Double tinhTongTien() {
//        for (CT_GioHang giohang : dsGioHang) {
//            tongTien +=  giohang.getThanhTien();
//        }
//        return tongTien;
//    }
    
    
    public void ghiGioHangVaoFile() {
        String fileName = "GioHang.data";
        File file = new File(fileName);
        try (FileWriter fileWriter = new FileWriter(file, true)) {
            for (CT_GioHang giohang : dsGioHang) {
                StringBuilder sb = new StringBuilder();
                sb.append(giohang.getMaKhachHang()).append("#");
                sb.append(giohang.getSach().getMaSach()).append("#");
                sb.append(giohang.getSach().getTenSach()).append("#");
                sb.append(giohang.getSach().getLoaiSach()).append("#");
                sb.append(giohang.getSoLuong()).append("#");
                sb.append(giohang.getThanhTien()).append("#");
                sb.append(System.lineSeparator()); //Xuống dòng
                fileWriter.write(sb.toString()); //Ghi chuỗi thông tin vào file
            }
            fileWriter.flush();
            System.out.println("Viet vao file thanh cong.....");
        } catch (IOException e) {
            System.out.println("Khong hop le" + e.getMessage());
        }
    }
    
    public void docTuFile(String tenTapTin) {
        File file = new File(tenTapTin);
        try (Scanner scanner = new Scanner(file)) {
            while (scanner.hasNextLine()) {
                String line = scanner.nextLine();
                String[] parts = line.split("#");

                CT_GioHang giohang= new CT_GioHang();
                giohang.setMaKhachHang(parts[0]);
                Sach sach = new Sach();
                sach.setMaSach(parts[1]);
                sach.setTenSach(parts[2]);
                sach.setLoaiSach(parts[3]);
                giohang.setSoLuong(Integer.parseInt(parts[4]));
                giohang.setThanhTien(Double.parseDouble(parts[5]));

                dsGioHang.add(giohang);
            }
        } catch (FileNotFoundException e) {
            System.err.println("Không tìm thấy file: " + e.getMessage());
        } catch (NumberFormatException e) {
            System.err.println("Lỗi khi phân tích số nguyên: " + e.getMessage());
        }
    }
    
    public void xemGioHang() {

}
    
    /*
    public void ghiGioHangVaoFile(String tenFile) {  
    try (DataOutputStream dos = new DataOutputStream(new FileOutputStream(tenFile))) {
        for (CT_GioHang giohang : dsSach) {
        dos.writeUTF(this.getMaKhachHang());
        dos.writeUTF(giohang.getSach().getMaSach());
        dos.writeUTF(giohang.getSach().getTenSach());
        dos.writeUTF(giohang.getSach().getLoaiSach());
        dos.writeInt(giohang.getSoLuong());
        dos.writeDouble(giohang.getThanhTien());
        // Ghi ngày, tháng, năm dưới dạng các số nguyên
//        if (this.ngayThanhlap != null) {
//            dos.writeInt(this.ngayThanhlap.getNgay());
//            dos.writeInt(this.ngayThanhlap.getThang());
//            dos.writeInt(this.ngayThanhlap.getNam());
//        } else {
//            // Ghi giá trị mặc định nếu ngayThanhlap là null
//            dos.writeInt(0); // Ngày mặc định
//            dos.writeInt(0); // Tháng mặc định
//            dos.writeInt(0); // Năm mặc định
//        }
        }
        dos.flush();
    } catch (IOException e) {
        System.err.println("Có lỗi khi ghi vào file: " + e.getMessage());
    }
}


    */

}
    
 
